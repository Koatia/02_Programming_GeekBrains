root@olga-VirtualBox:/home/olga# apt install docker.io docker-compose
Чтение списков пакетов… Готово
Построение дерева зависимостей… Готово
Чтение информации о состоянии… Готово
Будут установлены следующие дополнительные пакеты:
  bridge-utils containerd git git-man liberror-perl pigz python3-compose python3-docker python3-dockerpty
  python3-docopt python3-dotenv python3-texttable python3-websocket runc ubuntu-fan
Предлагаемые пакеты:
  ifupdown aufs-tools btrfs-progs cgroupfs-mount | cgroup-lite debootstrap docker-buildx docker-compose-v2 docker-doc
  rinse zfs-fuse | zfsutils git-daemon-run | git-daemon-sysvinit git-doc git-email git-gui gitk gitweb git-cvs
  git-mediawiki git-svn
Следующие НОВЫЕ пакеты будут установлены:
  bridge-utils containerd docker-compose docker.io git git-man liberror-perl pigz python3-compose python3-docker
  python3-dockerpty python3-docopt python3-dotenv python3-texttable python3-websocket runc ubuntu-fan
Обновлено 0 пакетов, установлено 17 новых пакетов, для удаления отмечено 0 пакетов, и 18 пакетов не обновлено.
Необходимо скачать 81,5 MB архивов.
После данной операции объём занятого дискового пространства возрастёт на 314 MB.
Хотите продолжить? [Д/н] Д
Пол:1 http://ru.archive.ubuntu.com/ubuntu noble/universe amd64 pigz amd64 2.8-1 [65,6 kB]
Пол:2 http://ru.archive.ubuntu.com/ubuntu noble/main amd64 bridge-utils amd64 1.7.1-1ubuntu2 [33,9 kB]
Пол:3 http://ru.archive.ubuntu.com/ubuntu noble/main amd64 runc amd64 1.1.12-0ubuntu3 [8 599 kB]
Пол:4 http://ru.archive.ubuntu.com/ubuntu noble/main amd64 containerd amd64 1.7.12-0ubuntu4 [38,6 MB]
Пол:5 http://ru.archive.ubuntu.com/ubuntu noble/universe amd64 python3-websocket all 1.7.0-1 [38,1 kB]
Пол:6 http://ru.archive.ubuntu.com/ubuntu noble/universe amd64 python3-docker all 5.0.3-1ubuntu1 [89,1 kB]
Пол:7 http://ru.archive.ubuntu.com/ubuntu noble/universe amd64 python3-dockerpty all 0.4.1-5 [11,4 kB]
Пол:8 http://ru.archive.ubuntu.com/ubuntu noble/universe amd64 python3-docopt all 0.6.2-6 [26,1 kB]
Пол:9 http://ru.archive.ubuntu.com/ubuntu noble/universe amd64 python3-dotenv all 1.0.1-1 [22,3 kB]
Пол:10 http://ru.archive.ubuntu.com/ubuntu noble/universe amd64 python3-texttable all 1.6.7-1 [11,0 kB]
Пол:11 http://ru.archive.ubuntu.com/ubuntu noble/universe amd64 python3-compose all 1.29.2-6ubuntu1 [84,6 kB]
Пол:12 http://ru.archive.ubuntu.com/ubuntu noble/universe amd64 docker-compose all 1.29.2-6ubuntu1 [14,0 kB]
Пол:13 http://ru.archive.ubuntu.com/ubuntu noble/universe amd64 docker.io amd64 24.0.7-0ubuntu4 [29,1 MB]
Пол:14 http://ru.archive.ubuntu.com/ubuntu noble/main amd64 liberror-perl all 0.17029-2 [25,6 kB]
Пол:15 http://ru.archive.ubuntu.com/ubuntu noble/main amd64 git-man all 1:2.43.0-1ubuntu7 [1 098 kB]
Пол:16 http://ru.archive.ubuntu.com/ubuntu noble/main amd64 git amd64 1:2.43.0-1ubuntu7 [3 674 kB]
Пол:17 http://ru.archive.ubuntu.com/ubuntu noble/universe amd64 ubuntu-fan all 0.12.16 [35,2 kB]
Получено 81,5 MB за 8с (10,2 MB/s)
Предварительная настройка пакетов …
Выбор ранее не выбранного пакета pigz.
(Чтение базы данных … на данный момент установлено 155250 файлов и каталогов.)
Подготовка к распаковке …/00-pigz_2.8-1_amd64.deb …
Распаковывается pigz (2.8-1) …
Выбор ранее не выбранного пакета bridge-utils.
Подготовка к распаковке …/01-bridge-utils_1.7.1-1ubuntu2_amd64.deb …
Распаковывается bridge-utils (1.7.1-1ubuntu2) …
Выбор ранее не выбранного пакета runc.
Подготовка к распаковке …/02-runc_1.1.12-0ubuntu3_amd64.deb …
Распаковывается runc (1.1.12-0ubuntu3) …
Выбор ранее не выбранного пакета containerd.
Подготовка к распаковке …/03-containerd_1.7.12-0ubuntu4_amd64.deb …
Распаковывается containerd (1.7.12-0ubuntu4) …
Выбор ранее не выбранного пакета python3-websocket.
Подготовка к распаковке …/04-python3-websocket_1.7.0-1_all.deb …
Распаковывается python3-websocket (1.7.0-1) …
Выбор ранее не выбранного пакета python3-docker.
Подготовка к распаковке …/05-python3-docker_5.0.3-1ubuntu1_all.deb …
Распаковывается python3-docker (5.0.3-1ubuntu1) …
Выбор ранее не выбранного пакета python3-dockerpty.
Подготовка к распаковке …/06-python3-dockerpty_0.4.1-5_all.deb …
Распаковывается python3-dockerpty (0.4.1-5) …
Выбор ранее не выбранного пакета python3-docopt.
Подготовка к распаковке …/07-python3-docopt_0.6.2-6_all.deb …
Распаковывается python3-docopt (0.6.2-6) …
Выбор ранее не выбранного пакета python3-dotenv.
Подготовка к распаковке …/08-python3-dotenv_1.0.1-1_all.deb …
Распаковывается python3-dotenv (1.0.1-1) …
Выбор ранее не выбранного пакета python3-texttable.
Подготовка к распаковке …/09-python3-texttable_1.6.7-1_all.deb …
Распаковывается python3-texttable (1.6.7-1) …
Выбор ранее не выбранного пакета python3-compose.
Подготовка к распаковке …/10-python3-compose_1.29.2-6ubuntu1_all.deb …
Распаковывается python3-compose (1.29.2-6ubuntu1) …
Выбор ранее не выбранного пакета docker-compose.
Подготовка к распаковке …/11-docker-compose_1.29.2-6ubuntu1_all.deb …
Распаковывается docker-compose (1.29.2-6ubuntu1) …
Выбор ранее не выбранного пакета docker.io.
Подготовка к распаковке …/12-docker.io_24.0.7-0ubuntu4_amd64.deb …
Распаковывается docker.io (24.0.7-0ubuntu4) …
Выбор ранее не выбранного пакета liberror-perl.
Подготовка к распаковке …/13-liberror-perl_0.17029-2_all.deb …
Распаковывается liberror-perl (0.17029-2) …
Выбор ранее не выбранного пакета git-man.
Подготовка к распаковке …/14-git-man_1%3a2.43.0-1ubuntu7_all.deb …
Распаковывается git-man (1:2.43.0-1ubuntu7) …
Выбор ранее не выбранного пакета git.
Подготовка к распаковке …/15-git_1%3a2.43.0-1ubuntu7_amd64.deb …
Распаковывается git (1:2.43.0-1ubuntu7) …
Выбор ранее не выбранного пакета ubuntu-fan.
Подготовка к распаковке …/16-ubuntu-fan_0.12.16_all.deb …
Распаковывается ubuntu-fan (0.12.16) …
Настраивается пакет python3-dotenv (1.0.1-1) …
Настраивается пакет python3-texttable (1.6.7-1) …
Настраивается пакет python3-docopt (0.6.2-6) …
Настраивается пакет runc (1.1.12-0ubuntu3) …
Настраивается пакет liberror-perl (0.17029-2) …
Настраивается пакет bridge-utils (1.7.1-1ubuntu2) …
Настраивается пакет pigz (2.8-1) …
Настраивается пакет git-man (1:2.43.0-1ubuntu7) …
Настраивается пакет containerd (1.7.12-0ubuntu4) …
Created symlink /etc/systemd/system/multi-user.target.wants/containerd.service → /usr/lib/systemd/system/containerd.service.
Настраивается пакет python3-websocket (1.7.0-1) …
Настраивается пакет python3-dockerpty (0.4.1-5) …
Настраивается пакет ubuntu-fan (0.12.16) …
Created symlink /etc/systemd/system/multi-user.target.wants/ubuntu-fan.service → /usr/lib/systemd/system/ubuntu-fan.service.
Настраивается пакет python3-docker (5.0.3-1ubuntu1) …
Настраивается пакет docker.io (24.0.7-0ubuntu4) …
info: Выбирается GID из диапазона от 100 по 999 ...
info: Добавляется группа «docker» (GID 125) ...
Created symlink /etc/systemd/system/multi-user.target.wants/docker.service → /usr/lib/systemd/system/docker.service.
Created symlink /etc/systemd/system/sockets.target.wants/docker.socket → /usr/lib/systemd/system/docker.socket.
Настраивается пакет python3-compose (1.29.2-6ubuntu1) …
Настраивается пакет git (1:2.43.0-1ubuntu7) …
Настраивается пакет docker-compose (1.29.2-6ubuntu1) …
Обрабатываются триггеры для man-db (2.12.0-4build2) …

root@olga-VirtualBox:/home/olga# root@olga-VirtualBox:/home/olga# docker

Usage:  docker [OPTIONS] COMMAND

A self-sufficient runtime for containers

Common Commands:
  run         Create and run a new container from an image
  exec        Execute a command in a running container
  ps          List containers
  build       Build an image from a Dockerfile
  pull        Download an image from a registry
  push        Upload an image to a registry
  images      List images
  login       Log in to a registry
  logout      Log out from a registry
  search      Search Docker Hub for images
  version     Show the Docker version information
  info        Display system-wide information

Management Commands:
  builder     Manage builds
  container   Manage containers
  context     Manage contexts
  image       Manage images
  manifest    Manage Docker image manifests and manifest lists
  network     Manage networks
  plugin      Manage plugins
  system      Manage Docker
  trust       Manage trust on Docker images
  volume      Manage volumes

Swarm Commands:
  swarm       Manage Swarm

Commands:
  attach      Attach local standard input, output, and error streams to a running container
  commit      Create a new image from a container's changes
  cp          Copy files/folders between a container and the local filesystem
  create      Create a new container
  diff        Inspect changes to files or directories on a container's filesystem
  events      Get real time events from the server
  export      Export a container's filesystem as a tar archive
  history     Show the history of an image
  import      Import the contents from a tarball to create a filesystem image
  inspect     Return low-level information on Docker objects
  kill        Kill one or more running containers
  load        Load an image from a tar archive or STDIN
  logs        Fetch the logs of a container
  pause       Pause all processes within one or more containers
  port        List port mappings or a specific mapping for the container
  rename      Rename a container
  restart     Restart one or more containers
  rm          Remove one or more containers
  rmi         Remove one or more images
  save        Save one or more images to a tar archive (streamed to STDOUT by default)
  start       Start one or more stopped containers
  stats       Display a live stream of container(s) resource usage statistics
  stop        Stop one or more running containers
  tag         Create a tag TARGET_IMAGE that refers to SOURCE_IMAGE
  top         Display the running processes of a container
  unpause     Unpause all processes within one or more containers
  update      Update configuration of one or more containers
  wait        Block until one or more containers stop, then print their exit codes

Global Options:
      --config string      Location of client config files (default "/root/.docker")
  -c, --context string     Name of the context to use to connect to the daemon (overrides DOCKER_HOST env var and
                           default context set with "docker context use")
  -D, --debug              Enable debug mode
  -H, --host list          Daemon socket to connect to
  -l, --log-level string   Set the logging level ("debug", "info", "warn", "error", "fatal") (default "info")
      --tls                Use TLS; implied by --tlsverify
      --tlscacert string   Trust certs signed only by this CA (default "/root/.docker/ca.pem")
      --tlscert string     Path to TLS certificate file (default "/root/.docker/cert.pem")
      --tlskey string      Path to TLS key file (default "/root/.docker/key.pem")
      --tlsverify          Use TLS and verify the remote
  -v, --version            Print version information and quit

Run 'docker COMMAND --help' for more information on a command.

For more help on how to use Docker, head to https://docs.docker.com/go/guides/

root@olga-VirtualBox:/home/olga# docker run hello-world
Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world
c1ec31eb5944: Pull complete
Digest: sha256:266b191e926f65542fa8daaec01a192c4d292bff79426f47300a046e1bc576fd
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
    (amd64)
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://hub.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/get-started/


root@olga-VirtualBox:/home/olga# ss -ntlp
State          Recv-Q          Send-Q                   Local Address:Port                    Peer Address:Port         Process
LISTEN         0               4096                        127.0.0.54:53                           0.0.0.0:*             users:(("systemd-resolve",pid=494,fd=17))
LISTEN         0               151                          127.0.0.1:3306                         0.0.0.0:*             users:(("mysqld",pid=1536,fd=24))
LISTEN         0               70                           127.0.0.1:33060                        0.0.0.0:*             users:(("mysqld",pid=1536,fd=21))
LISTEN         0               511                            0.0.0.0:80                           0.0.0.0:*             users:(("nginx",pid=1531,fd=5),("nginx",pid=1530,fd=5),("nginx",pid=1529,fd=5),("nginx",pid=1528,fd=5),("nginx",pid=1527,fd=5))
LISTEN         0               4096                     127.0.0.53%lo:53                           0.0.0.0:*             users:(("systemd-resolve",pid=494,fd=15))
LISTEN         0               4096                         127.0.0.1:43671                        0.0.0.0:*             users:(("containerd",pid=4772,fd=9))
LISTEN         0               4096                         127.0.0.1:631                          0.0.0.0:*             users:(("cupsd",pid=1407,fd=7))
LISTEN         0               511                                  *:8080                               *:*             users:(("apache2",pid=1526,fd=4),("apache2",pid=1525,fd=4),("apache2",pid=1524,fd=4),("apache2",pid=1523,fd=4),("apache2",pid=1521,fd=4),("apache2",pid=1495,fd=4))
LISTEN         0               511                               [::]:80                              [::]:*             users:(("nginx",pid=1531,fd=6),("nginx",pid=1530,fd=6),("nginx",pid=1529,fd=6),("nginx",pid=1528,fd=6),("nginx",pid=1527,fd=6))
LISTEN         0               4096                                 *:22                                 *:*             users:(("sshd",pid=1450,fd=3),("systemd",pid=1,fd=414))
LISTEN         0               4096                             [::1]:631                             [::]:*             users:(("cupsd",pid=1407,fd=6))
root@olga-VirtualBox:/home/olga# service nginx stop
root@olga-VirtualBox:/home/olga# ss -ntlp | grep 80
LISTEN 0      511                *:8080             *:*    users:(("apache2",pid=1526,fd=4),("apache2",pid=1525,fd=4),("apache2",pid=1524,fd=4),("apache2",pid=1523,fd=4),("apache2",pid=1521,fd=4),("apache2",pid=1495,fd=4))

root@olga-VirtualBox:/home/olga# sudo docker run -d --restart always --name nginx1 -p 80:80 -v /var/www/html:/usr/share/
nginx/html nginx
Unable to find image 'nginx:latest' locally
latest: Pulling from library/nginx
09f376ebb190: Pull complete
a11fc495bafd: Pull complete
933cc8470577: Pull complete
999643392fb7: Pull complete
971bb7f4fb12: Pull complete
45337c09cd57: Pull complete
de3b062c0af7: Pull complete
Digest: sha256:a484819eb60211f5299034ac80f6a681b06f89e65866ce91f356ed7c72af059c
Status: Downloaded newer image for nginx:latest
837986735ff6a04e9a4b80dc9489ab07b84a9a1aa2f7064b542e09e097a50b76

root@olga-VirtualBox:/home/olga# docker ps
CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS          PORTS                               NAMES
837986735ff6   nginx     "/docker-entrypoint.…"   46 seconds ago   Up 43 seconds   0.0.0.0:80->80/tcp, :::80->80/tcp   nginx1

root@olga-VirtualBox:/home/olga# docker logs nginx1
/docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration
/docker-entrypoint.sh: Looking for shell scripts in /docker-entrypoint.d/
/docker-entrypoint.sh: Launching /docker-entrypoint.d/10-listen-on-ipv6-by-default.sh
10-listen-on-ipv6-by-default.sh: info: Getting the checksum of /etc/nginx/conf.d/default.conf
10-listen-on-ipv6-by-default.sh: info: Enabled listen on IPv6 in /etc/nginx/conf.d/default.conf
/docker-entrypoint.sh: Sourcing /docker-entrypoint.d/15-local-resolvers.envsh
/docker-entrypoint.sh: Launching /docker-entrypoint.d/20-envsubst-on-templates.sh
/docker-entrypoint.sh: Launching /docker-entrypoint.d/30-tune-worker-processes.sh
/docker-entrypoint.sh: Configuration complete; ready for start up
2024/05/27 09:40:12 [notice] 1#1: using the "epoll" event method
2024/05/27 09:40:12 [notice] 1#1: nginx/1.25.5
2024/05/27 09:40:12 [notice] 1#1: built by gcc 12.2.0 (Debian 12.2.0-14)
2024/05/27 09:40:12 [notice] 1#1: OS: Linux 6.8.0-31-generic
2024/05/27 09:40:12 [notice] 1#1: getrlimit(RLIMIT_NOFILE): 1048576:1048576
2024/05/27 09:40:12 [notice] 1#1: start worker processes
2024/05/27 09:40:12 [notice] 1#1: start worker process 29
2024/05/27 09:40:12 [notice] 1#1: start worker process 30
2024/05/27 09:40:12 [notice] 1#1: start worker process 31
2024/05/27 09:40:12 [notice] 1#1: start worker process 32


root@olga-VirtualBox:/home/olga# root@olga-VirtualBox:/home/olga# curl -L "https://github.com/docker/compose/releases/download/1.25.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100 16.2M  100 16.2M    0     0  5998k      0  0:00:02  0:00:02 --:--:-- 10.4M
root@olga-VirtualBox:/home/olga# chmod +x /usr/local/bin/docker-compose
root@olga-VirtualBox:/home/olga# docker-compose --version
docker-compose version 1.25.0, build 0a186604

root@olga-VirtualBox:/home/olga# cd
root@olga-VirtualBox:~# ll
итого 68
drwx------  8 root root 4096 мая 24 22:54 ./
drwxr-xr-x 24 root root 4096 мая 15 00:16 ../
-rw-------  1 root root 6702 мая 24 22:56 .bash_history
-rw-r--r--  1 root root 3106 апр 22 16:04 .bashrc
drwx------  3 root root 4096 мая 15 00:16 .cache/
drwx------  3 root root 4096 мая 15 00:16 .config/
-rw-r--r--  1 root root  733 мая 21 12:50 ip.rules
drwx------  3 root root 4096 мая 16 22:18 .launchpadlib/
-rw-------  1 root root   20 мая 24 17:28 .lesshst
drwxr-xr-x  3 root root 4096 мая 14 23:43 .local/
-rw-------  1 root root  677 мая 24 22:54 .mysql_history
-rw-r--r--  1 root root  161 апр 22 16:04 .profile
-rw-r--r--  1 root root   66 мая 17 00:47 .selected_editor
drwx------  7 root root 4096 мая 17 00:21 snap/
drwx------  2 root root 4096 мая 10 17:47 .ssh/
-rw-r--r--  1 root root  211 мая 16 23:48 .wget-hsts
root@olga-VirtualBox:~# mkdir wordpress
root@olga-VirtualBox:~# cd wordpress
root@olga-VirtualBox:~/wordpress# ll
итого 8
drwxr-xr-x 2 root root 4096 мая 27 12:48 ./
drwx------ 9 root root 4096 мая 27 12:48 ../

root@olga-VirtualBox:~/wordpress# cat > .env
MYSQL_ROOT_PASSWORD=dfkljs_d324fD_klj
MYSQL_USER=wp
MYSQL_PASSWORD=KMJ23f9sad_80ds^C


root@olga-VirtualBox:~/wordpress# ll
итого 12
drwxr-xr-x 2 root root 4096 мая 27 12:49 ./
drwx------ 9 root root 4096 мая 27 12:48 ../
-rw-r--r-- 1 root root   52 мая 27 12:49 .env
root@olga-VirtualBox:~/wordpress# mkdir nginx-conf
root@olga-VirtualBox:~/wordpress# cd nginx-conf/
root@olga-VirtualBox:~/wordpress/nginx-conf# cat > nginx.conf


server {
        listen 80;
        listen [::]:80;

        server_name example.com www.example.com;

        index index.php index.html index.htm;

        root /var/www/html;

        location ~ /.well-known/acme-challenge {
                allow all;
                root /var/www/html;
        }

        location / {
                try_files $uri $uri/ /index.php$is_args$args;
        }

        location ~ \.php$ {
                try_files $uri =484;
                fastcgi_split_path_info ^(.+\.php)(/.+)$;
                fastcgi_pass wordpress:9000;
                fastcgi_index index.php;
                include fastcgi_params;
                fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
                fastcgi_param PATH_INFO $fastcgi_path_info;
        }

        location ~ /\.ht {
                deny all;
        }

        location = /favicon.ico {
                log_not_found off; access_log off;
        }
        location = /robots.txt {
                log_not_found off; access_log off; allow all;
        }
        location ~* \.(css|gif|ico|jpeg|jpg|js|png)$ {
                expires max;
                log_not_found off;
        }
}


root@olga-VirtualBox:~/wordpress# cat > docker-compose.yml

version:  '3'

services:
  db:
    image: mysql:8.0
    container_name: db
    restart: unless-stopped
    env_file: .env
    environment:
      - MYSQL_DATABASE=wordpress
    volumes:
      - dbdata:/var/lib/mysql
    command: '--default-authentication-plugin=mysql_native_password'
    networks:
      - app-network

  wordpress:
    depends_on:
      - db
    image: wordpress:6.0.1-php8.0-fpm-alpine
    container_name: wordpress
    restart: unless-stopped
    env_file: .env
    environment:
      - WORDPRESS_DB_HOST=db:3306
      - WORDPRESS_DB_USER=$MYSQL_USER
      - WORDPRESS_DB_PASSWORD=$MYSQL_PASSWORD
      - WORDPRESS_DB_NAME=wordpress
    volumes:
      - wordpress:/var/www/html
    networks:
      - app-network

  webserver:
    depends_on:
      - wordpress
    image: nginx:1.22.0-alpine
    container_name: webserver
    restart: unless-stopped
    ports:
      - "80:80"
    volumes:
      - wordpress:/var/www/html
      - ./nginx-conf:/etc/nginx/conf.d
    networks:
      - app-network
volumes:
  wordpress:
  dbdata:

networks:
    app-network:
      driver: bridge


root@olga-VirtualBox:~/wordpress# root@olga-VirtualBox:~/wordpress# apt install tree
Чтение списков пакетов… Готово
Построение дерева зависимостей… Готово
Чтение информации о состоянии… Готово
Следующие НОВЫЕ пакеты будут установлены:
  tree
Обновлено 0 пакетов, установлено 1 новых пакетов, для удаления отмечено 0 пакетов, и 18 пакетов не обновлено.
Необходимо скачать 47,1 kB архивов.
После данной операции объём занятого дискового пространства возрастёт на 111 kB.
Пол:1 http://ru.archive.ubuntu.com/ubuntu noble/universe amd64 tree amd64 2.1.1-2ubuntu3 [47,1 kB]
Получено 47,1 kB за 0с (445 kB/s)
Выбор ранее не выбранного пакета tree.
(Чтение базы данных … на данный момент установлено 156932 файла и каталога.)
Подготовка к распаковке …/tree_2.1.1-2ubuntu3_amd64.deb …
Распаковывается tree (2.1.1-2ubuntu3) …
Настраивается пакет tree (2.1.1-2ubuntu3) …
Обрабатываются триггеры для man-db (2.12.0-4build2) …
root@olga-VirtualBox:~/wordpress# tree
.
├── docker-compose.yml
└── nginx-conf
    └── nginx.conf

2 directories, 2 files

root@olga-VirtualBox:~/wordpress# ss -ntlp
State          Recv-Q          Send-Q                   Local Address:Port                    Peer Address:Port         Process
LISTEN         0               4096                        127.0.0.54:53                           0.0.0.0:*             users:(("systemd-resolve",pid=494,fd=17))
LISTEN         0               151                          127.0.0.1:3306                         0.0.0.0:*             users:(("mysqld",pid=1536,fd=24))
LISTEN         0               70                           127.0.0.1:33060                        0.0.0.0:*             users:(("mysqld",pid=1536,fd=21))
LISTEN         0               4096                           0.0.0.0:80                           0.0.0.0:*             users:(("docker-proxy",pid=5556,fd=4))
LISTEN         0               4096                     127.0.0.53%lo:53                           0.0.0.0:*             users:(("systemd-resolve",pid=494,fd=15))
LISTEN         0               4096                         127.0.0.1:43671                        0.0.0.0:*             users:(("containerd",pid=4772,fd=9))
LISTEN         0               4096                         127.0.0.1:631                          0.0.0.0:*             users:(("cupsd",pid=1407,fd=7))
LISTEN         0               511                                  *:8080                               *:*             users:(("apache2",pid=1526,fd=4),("apache2",pid=1525,fd=4),("apache2",pid=1524,fd=4),("apache2",pid=1523,fd=4),("apache2",pid=1521,fd=4),("apache2",pid=1495,fd=4))
LISTEN         0               4096                              [::]:80                              [::]:*             users:(("docker-proxy",pid=5563,fd=4))
LISTEN         0               4096                                 *:22                                 *:*             users:(("sshd",pid=1450,fd=3),("systemd",pid=1,fd=414))
LISTEN         0               4096                             [::1]:631                             [::]:*             users:(("cupsd",pid=1407,fd=6))
root@olga-VirtualBox:~/wordpress# docker ps
CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS          PORTS                               NAMES
837986735ff6   nginx     "/docker-entrypoint.…"   57 minutes ago   Up 57 minutes   0.0.0.0:80->80/tcp, :::80->80/tcp   nginx1
root@olga-VirtualBox:~/wordpress# docker stop nginx1
nginx1

root@olga-VirtualBox:~/wordpress# ss -ntlp
State          Recv-Q          Send-Q                   Local Address:Port                    Peer Address:Port         Process
LISTEN         0               4096                        127.0.0.54:53                           0.0.0.0:*             users:(("systemd-resolve",pid=494,fd=17))
LISTEN         0               151                          127.0.0.1:3306                         0.0.0.0:*             users:(("mysqld",pid=1536,fd=24))
LISTEN         0               70                           127.0.0.1:33060                        0.0.0.0:*             users:(("mysqld",pid=1536,fd=21))
LISTEN         0               4096                     127.0.0.53%lo:53                           0.0.0.0:*             users:(("systemd-resolve",pid=494,fd=15))
LISTEN         0               4096                         127.0.0.1:43671                        0.0.0.0:*             users:(("containerd",pid=4772,fd=9))
LISTEN         0               4096                         127.0.0.1:631                          0.0.0.0:*             users:(("cupsd",pid=1407,fd=7))
LISTEN         0               511                                  *:8080                               *:*             users:(("apache2",pid=1526,fd=4),("apache2",pid=1525,fd=4),("apache2",pid=1524,fd=4),("apache2",pid=1523,fd=4),("apache2",pid=1521,fd=4),("apache2",pid=1495,fd=4))
LISTEN         0               4096                                 *:22                                 *:*             users:(("sshd",pid=1450,fd=3),("systemd",pid=1,fd=414))
LISTEN         0               4096                             [::1]:631                             [::]:*             users:(("cupsd",pid=1407,fd=6))


root@olga-VirtualBox:~/wordpress# docker-compose up -d
WARNING: The MYSQL_PASSWORD variable is not set. Defaulting to a blank string.
Creating network "wordpress_app-network" with driver "bridge"
Creating volume "wordpress_wordpress" with default driver
Creating volume "wordpress_dbdata" with default driver
Pulling db (mysql:8.0)...
8.0: Pulling from library/mysql
fcbdc4090331: Pull complete
a845363d0003: Pull complete
e8058c6f9bdd: Pull complete
2ec357e5ab0c: Pull complete
5afcf1382f34: Pull complete
7e6fb392497b: Pull complete
0287ae8ee890: Pull complete
faa49449b97e: Pull complete
ddd0836d7ff3: Pull complete
c25cb9740165: Pull complete
8d993d969e2b: Pull complete
Digest: sha256:aba83ec239df64820f61f0436b30c17922cf3cc183878ad4e479950bbedd448e
Status: Downloaded newer image for mysql:8.0
Pulling wordpress (wordpress:6.0.1-php8.0-fpm-alpine)...
6.0.1-php8.0-fpm-alpine: Pulling from library/wordpress
213ec9aee27d: Pull complete
a600fdbc30cc: Pull complete
0cdd6cb15c0d: Pull complete
8a4c40d8aee7: Pull complete
dc46439651c5: Pull complete
10daf3bb75f7: Pull complete
e5c81b969745: Pull complete
20155bcd6db0: Pull complete
d0bf714501bd: Pull complete
83db60181efd: Pull complete
c64cb3569601: Pull complete
175f677f2dba: Pull complete
2f1a58af64c7: Pull complete
c8196a01df6c: Pull complete
8c8b2ba43b10: Pull complete
fbe3c3cf4b2c: Pull complete
10cb6719e50f: Pull complete
Digest: sha256:d3620317e46fc74adc98e7811a3ec60d887be277bf63c527ecc219e164663187
Status: Downloaded newer image for wordpress:6.0.1-php8.0-fpm-alpine
Pulling webserver (nginx:1.22.0-alpine)...
1.22.0-alpine: Pulling from library/nginx
213ec9aee27d: Already exists
1bfd2b69cf63: Pull complete
a19f4cc2e029: Pull complete
4ae981811a6d: Pull complete
7a662f439736: Pull complete
a317c3c2c906: Pull complete
Digest: sha256:addd3bf05ec3c69ef3e8f0021ce1ca98e0eb21117b97ab8b64127e3ff6e444ec
Status: Downloaded newer image for nginx:1.22.0-alpine
Creating db ... done
Creating wordpress ... done
Creating webserver ... done

root@olga-VirtualBox:~/wordpress# docker-compose ps
  Name                 Command               State                Ports
-------------------------------------------------------------------------------------
db          docker-entrypoint.sh --def ...   Up      3306/tcp, 33060/tcp
webserver   /docker-entrypoint.sh ngin ...   Up      0.0.0.0:80->80/tcp,:::80->80/tcp
wordpress   docker-entrypoint.sh php-fpm     Up      9000/tcp

root@olga-VirtualBox:~/wordpress# docker ps
CONTAINER ID   IMAGE                               COMMAND                  CREATED              STATUS              PORTS                               NAMES
ef2f0a3ad85d   nginx:1.22.0-alpine                 "/docker-entrypoint.…"   About a minute ago   Up About a minute   0.0.0.0:80->80/tcp, :::80->80/tcp   webserver
a56181e81da7   wordpress:6.0.1-php8.0-fpm-alpine   "docker-entrypoint.s…"   About a minute ago   Up About a minute   9000/tcp                            wordpress
be8c23bf7d37   mysql:8.0                           "docker-entrypoint.s…"   About a minute ago   Up About a minute   3306/tcp, 33060/tcp                 db



root@olga-VirtualBox:~/wordpress# curl -L localhost
<!DOCTYPE html>
<html dir='ltr'>
<head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="viewport" content="width=device-width">
                        <title>Database Error</title>
        <style type="text/css">
                html {
                        background: #f1f1f1;
                }
                body {
                        background: #fff;
                        border: 1px solid #ccd0d4;
                        color: #444;
                        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
                        margin: 2em auto;
                        padding: 1em 2em;
                        max-width: 700px;
                        -webkit-box-shadow: 0 1px 1px rgba(0, 0, 0, .04);
                        box-shadow: 0 1px 1px rgba(0, 0, 0, .04);
                }
                h1 {
                        border-bottom: 1px solid #dadada;
                        clear: both;
                        color: #666;
                        font-size: 24px;
                        margin: 30px 0 0 0;
                        padding: 0;
                        padding-bottom: 7px;
                }
                #error-page {
                        margin-top: 50px;
                }
                #error-page p,
                #error-page .wp-die-message {
                        font-size: 14px;
                        line-height: 1.5;
                        margin: 25px 0 20px;
                }
                #error-page code {
                        font-family: Consolas, Monaco, monospace;
                }
                ul li {
                        margin-bottom: 10px;
                        font-size: 14px ;
                }
                a {
                        color: #0073aa;
                }
                a:hover,
                a:active {
                        color: #006799;
                }
                a:focus {
                        color: #124964;
                        -webkit-box-shadow:
                                0 0 0 1px #5b9dd9,
                                0 0 2px 1px rgba(30, 140, 190, 0.8);
                        box-shadow:
                                0 0 0 1px #5b9dd9,
                                0 0 2px 1px rgba(30, 140, 190, 0.8);
                        outline: none;
                }
                .button {
                        background: #f3f5f6;
                        border: 1px solid #016087;
                        color: #016087;
                        display: inline-block;
                        text-decoration: none;
                        font-size: 13px;
                        line-height: 2;
                        height: 28px;
                        margin: 0;
                        padding: 0 10px 1px;
                        cursor: pointer;
                        -webkit-border-radius: 3px;
                        -webkit-appearance: none;
                        border-radius: 3px;
                        white-space: nowrap;
                        -webkit-box-sizing: border-box;
                        -moz-box-sizing:    border-box;
                        box-sizing:         border-box;

                        vertical-align: top;
                }

                .button.button-large {
                        line-height: 2.30769231;
                        min-height: 32px;
                        padding: 0 12px;
                }

                .button:hover,
                .button:focus {
                        background: #f1f1f1;
                }

                .button:focus {
                        background: #f3f5f6;
                        border-color: #007cba;
                        -webkit-box-shadow: 0 0 0 1px #007cba;
                        box-shadow: 0 0 0 1px #007cba;
                        color: #016087;
                        outline: 2px solid transparent;
                        outline-offset: 0;
                }

                .button:active {
                        background: #f3f5f6;
                        border-color: #7e8993;
                        -webkit-box-shadow: none;
                        box-shadow: none;
                }

                        </style>
</head>
<body id="error-page">
        <div class="wp-die-message"><h1>Error establishing a database connection</h1></div></body>
</html>


root@olga-VirtualBox:~/wordpress# root@olga-VirtualBox:~/wordpress# docker network create some-network
root@olga-VirtualBox:~/wordpress# docker run --rm --network some-network --name some-mariadb -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mariadb:10.8
Unable to find image 'mariadb:10.8' locally
10.8: Pulling from library/mariadb
d1669123f281: Pull complete
7942299fe584: Pull complete
ca116927bbe1: Pull complete
9c0f0b5293ed: Pull complete
ee0988afd61a: Pull complete
82d81fccd49d: Pull complete
7e361405ea73: Pull complete
be365127aa3f: Pull complete
Digest: sha256:456709ab146585d6189da05669b84384518baecd83670c9e5221f8c20a47cf1e
Status: Downloaded newer image for mariadb:10.8
41ebb0a8c508293d47a56c0b754697871e78aada921d5b79bd7446accaa46eb9
root@olga-VirtualBox:~/wordpress# docker run --name myadmin -d --network some-network --link some-mariadb:db -p 8082:80 phpmyadmin
Unable to find image 'phpmyadmin:latest' locally
latest: Pulling from library/phpmyadmin
09f376ebb190: Already exists
76afcdc86551: Pull complete
ceed4541c527: Pull complete
9ec84be954b0: Pull complete
ff0e278869f9: Pull complete
1693466e4cc6: Pull complete
57c8d94a4882: Pull complete
43af3fe8136a: Pull complete
ddef75e08a5d: Pull complete
a4ba0bdbbf0a: Pull complete
29e89bc69515: Pull complete
bdad27815722: Pull complete
dbbbc9a88332: Pull complete
dbb7df25a76e: Pull complete
2cedf1ee513b: Pull complete
b29f15d25d61: Pull complete
0c455ba0c479: Pull complete
87f4d138451a: Pull complete
Digest: sha256:07fd21913ecb7cc08e9b731a2a623e421fee5210de1f24fe2a58b77e8cc32427
Status: Downloaded newer image for phpmyadmin:latest
0cd0776195d7d222d41ec7f97d3eab4fd003f8f88a165534e2f785a9d92a690d
root@olga-VirtualBox:~/wordpress# docker ps
CONTAINER ID   IMAGE                               COMMAND                  CREATED          STATUS          PORTS                                   NAMES
0cd0776195d7   phpmyadmin                          "/docker-entrypoint.…"   36 seconds ago   Up 31 seconds   0.0.0.0:8082->80/tcp, :::8082->80/tcp   myadmin
41ebb0a8c508   mariadb:10.8                        "docker-entrypoint.s…"   2 minutes ago    Up 2 minutes    3306/tcp                                some-mariadb
ef2f0a3ad85d   nginx:1.22.0-alpine                 "/docker-entrypoint.…"   17 minutes ago   Up 16 minutes   0.0.0.0:80->80/tcp, :::80->80/tcp       webserver
a56181e81da7   wordpress:6.0.1-php8.0-fpm-alpine   "docker-entrypoint.s…"   17 minutes ago   Up 17 minutes   9000/tcp                                wordpress
be8c23bf7d37   mysql:8.0                           "docker-entrypoint.s…"   17 minutes ago   Up 17 minutes   3306/tcp, 33060/tcp




